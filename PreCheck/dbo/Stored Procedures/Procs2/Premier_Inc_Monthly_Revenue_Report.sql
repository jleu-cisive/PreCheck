


-- exec Premier_Inc_Monthly_Revenue_Report 11/1/2020', '11/30/2020'
-- Modified bY Radhika Dereddy on 11/08/2021 to add CLNO in the where clause.
-- Modified by Sindhura Modupalli on 1/21/2022 to add CLNO in where clause for HDT 33679 17209,16783,17189,17203,17181,
--17069

CREATE Procedure [dbo].[Premier_Inc_Monthly_Revenue_Report]
(
@StartDate DateTime = '3/1/2012', 
@EndDate DateTime = '3/31/2012'

) 
 as 

-- declare @StartDate DateTime = '1/1/2012', 
--@EndDate DateTime = '3/31/2012'
select 
'867010710' as Version_control_#,
'P' as	Test_vs_Production,
'PreCheck, Inc.' as Vendor_Name,
'' as	Vendor_GLN,
'626740' as Vendor_Premier_Entity_Code,
'' as Vendor_DEA,'' as	Vendor_HIN,
'' as Facility_GLN,
'' as Facility_Premier_Entity_Code,	
'' as Facility_DEA,'' as	Facility_HIN,
'PP-SV-180' as	Premier_Agreement_#,
'' as Period_Begin_Date, '' as	Period_End_Date,
Name as Facility_Name, Addr1 + Addr2 as Facility_Address_1, 
--Addr2 as Facility_Address_2,
City as	Facility_City,	State as Facility_State, ZIP as	Facility_Zip_Code
,'' as Manufacturer_Item_#,'' as Vendor_Item_Number,'' as	GTIN,'' as	UPN_Type,'' as	UPN,'' as	UPC_Type,'' as	UPC,'' as	NDC
,'Background CheckServices' as	Product_Description,'EA' as	Unit_of_Measure
,'' as Unit_Price,
Sale as Total_Sales_Dollars	,
(select count(distinct APNO) from InvDetail where InvoiceNumber = IM.InvoiceNumber and Description like 'Package:%') as  Total_Sales_Qty,	
InvDate as Invoice_Date	,
InvoiceNumber as Invoice_Number	
,'' as Order_Date,'' as Delivery_Date,'' as	Administration_Fee_Amount,'D' as	Direct_Indirect,
C.CLNO as Internal_Customer_Number
FROM Client C
INNER JOIN  InvMaster IM on  C.clno = IM.CLNO
--inner join InvDetail ID on IM.InvoiceNumber = ID.InvoiceNumber
where C.CLNO in (2167,2227,2228,2402,2892,3035,3041,6153,7439,7678,8050,8424,8426,8635,8779,8871,8974,10220,10221,13126,13127,13128,13129,13187,
13188,13189,13190,13191,13192,13193,13194,13196,13198,13199,13200,13201,13202,13204,13205,13206,13208,13209,13210,13211,13212,13213,13214,13215,
13216,13217,13218,13220,13221,13222,13223,13224,13225,13226,13227,13228,13229,13230,13231,13232,13233,13234,13235,13236,13237,13238,13239,13240,
13241,13242,13243,13244,13245,13246,13248,13249,13252,13253,13254,13255,13256,13257,13258,13259,13260,13261,13262,13263,13264,13266,13267,13268,
13269,13270,13271,13272,13274,13276,13277,13278,13279,13280,13281,13283,13284,13285,13286,13287,13288,13289,13291,13292,13294,13296,13297,13298,
13299,13300,13302,13303,13304,13305,13306,13307,13308,13309,13310,13312,13313,13314,13316,13317,13318,13320,13321,13322,13324,13326,13327,13328,
13329,13330,13331,13333,13334,13335,13336,13337,13338,13339,13340,13342,13343,13344,13345,13346,13347,13348,13349,13350,13351,13352,13353,13354,
13355,13357,13358,13359,13361,13362,13363,13364,13365,13366,13368,13369,13370,13371,13372,13373,13374,13375,13376,13377,13378,13379,13380,13381,
13382,13383,13384,13385,13386,13387,13389,13390,13392,13393,13394,13395,13397,13398,13399,13400,13401,13402,13403,13404,13405,13406,13408,13409,
13410,13412,13413,13414,13415,13416,13417,13418,13419,13420,13421,13422,13424,13425,13426,13427,13429,13430,13431,13432,13433,13435,13436,13437,
13438,13439,13440,13441,13442,13443,13444,13446,13447,13448,13449,13450,13451,13452,13453,13454,13613,13743,13744,13745,13746,13747,13748,13750,
13751,13753,13754,13755,13763,13764,13766,13767,13768,13770,13772,13774,13776,13778,13780,13781,13782,13784,13785,13786,13787,13791,13792,13795,
13796,13798,13803,13805,13810,13813,13816,13818,13820,13942,13943,13944,13945,13947,13948,13949,13952,14066,14092,14192,14247,14287,14344,14399,
14520,14521,14603,14645,14654,14705,14758,14767,15231,15356,15357,15359,15360,15380,15383,15385,15386,15387,15389,15391,15392,15393,15394,15395,
15396,15397,15398,15399,15400,15401,15402,15403,15404,15405,15406,15407,15408,15409,15410,15411,15412,15413,15414,15415,15416,15417,15418,15419,
15420,15421,15422,15423,15424,15433,15434,15438,15439,15440,15441,15442,15443,15444,15445,15446,15447,15449,15452,15453,15456,15459,15462,15465,
15466,15467,15468,15472,15482,15483,15484,15485,15488,15490,15491,15492,15494,15496,15498,15500,15501,15502,15503,15505,15506,15507,15508,15510,
15511,15512,15514,15515,15516,15517,15519,15522,15523,15542,15585,15587,15628,15630,15879,15883,15884,15896,15925,15944,15984,16010,16020,16026,
16027,16057,16135,16139,16146,16155,16215,16221,16222,16223,16224,16226,16227,16231,16233,16234,16235,16236,16237,16238,16244,16246,16247,16248,
16259,16260,16267,16281,16282,16284,16285,16286,16287,16301,16308,16325,16349,16350,16370,16375,16394,16402,16427,16456,16462,16511,16136,16548,
16565,16626,16702,16674,16649,16402,16715,16717,16718,16732,16758,16764,13794,15450,15451,15454,15458,15470,15495,15497,15520,15880,16013,
16216,16217,16219,16220,16225,16228,16229,16232,16239,16240,16241,16243,16245,16533,16707,16735,16898,16729,13126,13275,13356,15464,15477,16242,
16283,16591,16778,17035,17069,17077,17079,17096,17097,17098,17122,16758,17147,17155,17139,12881,12914,12882,12913,17209,16783,17189,17203,17181,
17069


)
and InvDate between @StartDate and @EndDate
